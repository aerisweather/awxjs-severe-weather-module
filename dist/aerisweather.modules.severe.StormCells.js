/*!
 * 
 * awxjs-severe-weather-module - 1.0.0
 * (c) 2021 Ben Collin
 * License: MIT
 * https://www.aerisweather.com/support/docs/toolkits/aeris-js-sdk/
 * 
 */
(this.webpackJsonp=this.webpackJsonp||[]).push([[2],{PRtd:function(e,t,a){"use strict";a.r(t);var n,i=a("CUUi"),r=a.n(i),l=a("jNhv"),s=a("+mSH"),o=a("lTyK"),c=a("fdqv"),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),p=function(){return(p=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},d={general:"#2ed300",hail:"#ebe100",rotating:"#f17200",tornado:"#ff2600"},f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return"stormcells"},enumerable:!1,configurable:!0}),t.prototype.source=function(){var e=this;return{type:"vector",requiresBounds:!0,data:{service:function(){return e.request},properties:{id:"id",path:"points",category:"traits.type",timestamp:"ob.timestamp",points:"points"},formatter:function(e){return Object(c.a)(e)}},style:{marker:function(e){return Object(c.c)(e)},polyline:function(){return{stroke:{color:"#ffffff",width:3}}}}}},t.prototype.infopanel=function(){var e=this;return{request:function(t){var a=Object(l.get)(t,"stormcells.forecast.locs")||[];if(a&&0!==a.length){var n=e.account.api();return a.forEach((function(t){var a=t.lat,i=t.long,r=e.account.api().endpoint("places").place(a+","+i).radius("10mi").fields("place.name,place.state");n.addRequest(r)})),n}},views:[{requiresData:!0,data:function(e){if(Object(l.get)(e,"stormcells"))return e},renderer:function(e){if(e){var t,a=e.stormcells,n=a.place,i=a.movement,r=a.traits,c=void 0===r?{}:r,u=e.metric,p=Object(s.toName)(n.name)+", "+n.state.toUpperCase(),f=Object(l.isset)(i)?'\n                            <div class="awxjs__ui-row">\n                                <div>\n                                    Moving '+i.dirTo+"\n                                    at "+Object(o.formatDataValue)(i,"speedMPH","speedKMH",u)+"\n                                </div>\n                            </div>\n                        ":"";return'\n                        <div class="stormtrack-loc awxjs__app__ui-panel-info__table">\n                            <div class="awxjs__ui-row">\n                                <div class="awxjs__ui-cols align-center">\n                                    <div class="awxjs__ui-expand awxjs__text-lg value">\n                                        <strong>Near '+p+'</strong>\n                                    </div>\n                                    <div>\n                                        <div class="indicator" style="background:'+(t=((t=c.type)||"none").toLowerCase(),(d[t]||"#999999")+';"></div>\n                                    </div>\n                                </div>\n                            </div>\n                            ')+f+"\n                        </div>\n                    "}}},{requiresData:!0,data:function(e){var t=Object(l.get)(e,"stormcells");if(t){var a=t.dbzm,n=[];Object(l.isset)(a)&&n.push({type:"intensity",name:"Intensity",value:a});var i=function(e){void 0===e&&(e={});var t=e.hail,a=e.tvs,n=e.traits,i=0;(Object(l.isset)(t)&&t.probSevere>0&&(i=t.probSevere/10),Object(l.isset)(n)&&i<10)&&(n.rotating&&(i=7),n.tornado&&(i=10));return i<8&&1===a&&(i=8),i}(e.stormcells);return n.push({type:"severity",name:"Severity",value:i}),n}},renderer:function(e){return'\n                        <div class="awxjs__app__ui-panel-info__hazards">\n                            '+e.map((function(e){var t,a=0,n="";if("intensity"===e.type){var i=(t=e.value)>=60?{index:5,label:"Extreme"}:t>=55?{index:4,label:"Very Heavy"}:t>=50?{index:3,label:"Heavy"}:t>=35?{index:2,label:"Moderate"}:t>=20?{index:1,label:"Light"}:{index:0,label:"Very Light"};a=i.index,n=i.label}else if("severity"===e.type){var r=function(e){var t=Math.floor(e/2);return{index:t,label:["None","Minimal","Low","Moderate","High","Extreme"][t]}}(e.value);a=r.index,n=r.label}var l=(""+a).replace(/\./g,"p"),s=Math.round(a/5*1e3)/10;return'\n                            <div class="awxjs__app__ui-panel-info__hazard awxjs__ui-cols align-center">\n                                <div class="awxjs__app__ui-panel-info__hazard-label">\n                                    '+e.name+'\n                                </div>\n                                <div class="awxjs__app__ui-panel-info__hazard-bar">\n                                    <div class="awxjs__app__ui-panel-info__hazard-bar-inner">\n                                        <div\n                                            class="awxjs__app__ui-panel-info__hazard-bar-progress\n                                                awxjs__app__ui-panel-info__hazard-indice-fill-'+l+'"\n                                            style="width:'+s+'%;"\n                                        ></div>\n                                    </div>\n                                </div>\n                                <div\n                                    class="awxjs__app__ui-panel-info__hazard-value\n                                        awxjs__app__ui-panel-info__hazard-value-'+l+'"\n                                    >'+n+"</div>\n                            </div>\n                        "})).join("")+"\n                        </div>\n                    "}},{title:"Forecast Track",requiresData:!0,data:function(e){var t=Object(l.get)(e,"stormcells.forecast.locs");if(t){var a=t.map((function(t){var a="places_"+t.lat+"_"+t.long,n=e[a];return!(!n||!Object(l.isset)(n.place))&&p({timestamp:t.timestamp},n)})).filter((function(e){return e}));if(0!==a.length)return e.locations=a,e}},renderer:function(e){var t=Object(l.get)(e,"locations")||[],a=[];return'\n                        <div class="awxjs__app__ui-panel-info__table">\n                            '+t.map((function(e){var t=e.place,n=e.timestamp;if(!a.includes(t.name)){a.push(t.name);var i=Object(l.formatDate)(new Date(1e3*n),"h:mm a");return'\n                            <div class="awxjs__ui-row">\n                                <div class="awxjs__ui-expand label">'+t.name+'</div>\n                                <div class="awxjs__ui-expand value">'+i+"</div>\n                            </div>\n                        "}})).filter((function(e){return void 0!==e})).join("\n")+"\n                        </div>\n                    "}},{requiresData:!0,data:function(e){var t=Object(l.get)(e,"stormcells");if(t)return t},renderer:function(e){var t=e.metric,a=e.timestamp,n=e.radarID,i=e.dbzm,r=e.tvs,s=e.mda,c=e.vil;return'\n                        <div class="awxjs__app__ui-panel-info__table">\n                            '+[{label:"Observed",value:Object(l.formatDate)(new Date(1e3*a),"h:mm a, MMM d, yyyy")},{label:"Radar Station",value:n},{label:"Max Reflectivity",value:i+" dbz"},{label:"Echo Top",value:Object(o.formatDataValue)(e,"htFT","htM",t)},{label:"TVS",value:1===r?"Yes":"No"},{label:"Hail",value:(Object(l.get)(e,"hail.prob")||0)+"% Probability"},{label:"Severe Hail",value:(Object(l.get)(e,"hail.probSevere")||0)+"% Probability"},{label:"Max Hail Size",value:Object(o.formatDataValue)(e,"hail.maxSizeIN","hail.maxSizeCM",t)},{label:"MDA",value:s},{label:"VIL",value:c}].reduce((function(e,t){return e.push('\n                            <div class="awxjs__ui-row">\n                                <div class="awxjs__ui-expand label">'+t.label+'</div>\n                                <div class="awxjs__ui-expand value">'+t.value+"</div>\n                            </div>\n                        "),e}),[]).join("\n")+"\n                        </div>\n                    "}}]}},t.prototype.controls=function(){return{value:this.id,title:"Storm Cells"}},t.prototype.onInit=function(){var e=this.account.api().endpoint("stormcells");this.request=e},t.prototype.onMarkerClick=function(e,t){if(t){var a=t.id,n=t.radarID+"_"+t.cellID;this.showInfoPanel("Cell "+n).load({p:a},{stormcells:t})}},t}(r.a);t.default=f},fdqv:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a("jNhv"),i=(a("+mSH"),function(){return(i=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)}),r=function(e){return e*Math.PI/180},l=function(e,t,a,n){var i=r(e),l=r(t),s=r(a),o=r(n),c=Math.sin(o-l)*Math.cos(s),u=Math.cos(i)*Math.sin(s)-Math.sin(i)*Math.cos(s)*Math.cos(o-l),p=Math.atan2(c,u);return((p=180*p/Math.PI)+360)%360},s=function(e){switch(e=e.toLowerCase()){case"general":return"#2ED300";case"hail":return"#EBE100";case"rotating":return"#F17200";case"tornado":return"#FF2600";default:return"#000000"}},o=function(e){var t=e.isCurrent,a=e.isLast,i=Object(n.get)(e,"traits.type");return a?{className:"marker-stormcell",svg:{hidden:!0,shape:{type:"path",path:"M51.9,49.1L30.4,11.8L9,49.1C9,49.1,51.9,49.1,51.9,49.1z",fill:{color:"#ffffff"},transform:"rotate("+(e.bearing?e.bearing:0)+",30,30)"},viewBox:"0 0 60 60"},size:[16,16]}:{className:"marker-stormcell",svg:{shape:{type:"circle",fill:{color:s(i)},stroke:{color:"#ffffff",width:2}}},size:t?[15,15]:[10,10]}},c=function(e){return Object(n.isArray)(e)&&e.forEach((function(e){var t=e.id,a=e.ob,n=e.loc,r=e.forecast,s=e.place,o=e.traits,c=e.points,u=n.lat,p=n.long;c=[i(i({id:t},a),{traits:o,forecast:r,place:s,loc:{lat:n.lat,lon:n.long},isCurrent:!0})],r&&r.locs&&(r.locs||[]).forEach((function(e){var t=e.lat,n=e.long,d=l(u,p,t,n),f=!1;r.locs[r.locs.length-1]===e&&(f=!0,c.push(i(i({},a),{timestamp:e.timestamp,dateTimeISO:e.dateTimeISO,bearing:d,place:s,forecast:r,traits:o,loc:{lat:e.lat,lon:e.long},isCurrent:!1,isLast:f})))})),e.points=c})),e},u=function(e){var t="";return"snow"!==e.cat||Object(n.isEmpty)(e.detail.snowIN)||(t=e.detail.snowIN+" inches"),"wind"!==e.cat||Object(n.isEmpty)(e.detail.windSpeedMPH)||(t=e.detail.windSpeedMPH+" mph"),"rain"!==e.cat||Object(n.isEmpty)(e.detail.rainIN)||(t=e.detail.rainIN+" inches"),"hail"!==e.cat||Object(n.isEmpty)(e.detail.hailIN)||(t=e.detail.hailIN+" inches"),t}}}]);
//# sourceMappingURL=aerisweather.modules.severe.StormCells.js.map